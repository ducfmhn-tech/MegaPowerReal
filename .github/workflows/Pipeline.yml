name: MegaPower Prediction Pipeline
Kích hoạt workflow
on:
1. Chạy theo lịch trình: 03:00 UTC mỗi ngày (tương đương 10:00 sáng Việt Nam)
schedule:
- cron: '0 3 * * *'
2. Kích hoạt thủ công qua giao diện GitHub
workflow_dispatch:
jobs:
run:
# Chọn runner: Ubuntu Linux mới nhất
runs-on: ubuntu-latest
steps:
  - name: Checkout Code
    uses: actions/checkout@v4

  - name: Setup Python
    uses: actions/setup-python@v4
    with:
      python-version: '3.10'

  - name: Install Dependencies
    run: |
      python -m pip install --upgrade pip
      pip install -r requirements.txt

  - name: Run Prediction Pipeline
    # Truyền các biến môi trường bảo mật (secrets) cần thiết cho email vào
    env:
      EMAIL_SENDER: ${{ secrets.EMAIL_SENDER }}
      EMAIL_PASSWORD: ${{ secrets.EMAIL_PASSWORD }}
      EMAIL_RECEIVER: ${{ secrets.EMAIL_RECEIVER }}
      GMAIL_USER: ${{ secrets.GMAIL_USER }}
      GMAIL_APP_PASSWORD: ${{ secrets.GMAIL_APP_PASSWORD }}
    run: |
      # main.py sẽ thực hiện fetch, train, predict và send email
      python main.py

  - name: Upload outputs (Data and Reports)
    uses: actions/upload-artifact@v4
    with:
      name: mega_power_outputs
      # Upload cả dữ liệu thô và báo cáo cuối cùng
      path: |
        data/
        reports/
      retention-days: 7 # Giữ artifact trong 7 ngày
